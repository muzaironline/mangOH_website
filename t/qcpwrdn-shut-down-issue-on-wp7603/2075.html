<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Qcpwrdn shut down issue on WP7603 - mangOH Red - mangOH forum</title>
    <meta name="description" content="Hi, 
We’re seeing an issue on our mangOH Red units that shutdown for unexplained reasons. Here is a crash log we were able to extract. 
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011285] irq 50, desc: cefdb000,&amp;hellip;">
    <meta name="generator" content="Discourse 3.2.0.beta2-dev - https://github.com/discourse/discourse version 11176407155714e2ebc3885a5f3301a2b4d37c5b">
<link rel="icon" type="image/png" href="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/c8f691ef20d8b5ee5eb3e88daa9a37267fd8b5c6_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/c9436805837dffdd4ff80102c98ca366d74fee66_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075" />

<link rel="search" type="application/opensearchdescription+xml" href="https://forum.mangoh.io/opensearch.xml" title="mangOH forum Search">

    <link href="https://sea2.discourse-cdn.com/business6/stylesheets/color_definitions_mangoh-color-scheme_1_1_22c40ac3b958048f5d2773ba7c6e0a583de42cca.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/checklist_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-adplugin_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-adplugin"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-akismet_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-akismet"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-cakeday_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-data-explorer_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-data-explorer"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-details_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-footnote_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-footnote"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-lazy-videos_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-local-dates_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-narrative-bot_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-policy_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-policy"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-post-voting_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-post-voting"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-presence_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-solved_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-solved"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-spoiler-alert_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-spoiler-alert"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-templates_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-templates"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-topic-voting_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/hosted-site_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="hosted-site"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/poll_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-post-voting_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-post-voting_desktop"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-topic-voting_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/poll_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/desktop_theme_1_ab9b3e277688d87911f25cd6e1b20eb3d4321381.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="1" data-theme-name="mangoh"/>

    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-718568-6" data-json="{&quot;cookieDomain&quot;:&quot;mangoh.io&quot;}" data-auto-link-domains="">

  <link rel="preload" href="https://global.discourse-cdn.com/business6/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.br.js" as="script">
<script defer src="https://global.discourse-cdn.com/business6/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.br.js"></script>


        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Qcpwrdn shut down issue on WP7603&#39;" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075.rss" />
    <meta property="og:site_name" content="mangOH forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/3a6474224b6583b6512ef6a5cd02d7d66cc320b7.png" />
<meta property="og:image" content="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/3a6474224b6583b6512ef6a5cd02d7d66cc320b7.png" />
<meta property="og:url" content="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075" />
<meta name="twitter:url" content="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075" />
<meta property="og:title" content="Qcpwrdn shut down issue on WP7603" />
<meta name="twitter:title" content="Qcpwrdn shut down issue on WP7603" />
<meta property="og:description" content="Hi,  We’re seeing an issue on our mangOH Red units that shutdown for unexplained reasons. Here is a crash log we were able to extract.  Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011285] irq 50, desc: cefdb000, depth: 0, count: 0, unhandled: 0 Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011308] -&gt;handle_irq():  c025ac68, msm_gpio_irq_handler+0x0/0x150 Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011338] -&gt;irq_data.chip(): c0ed8e68, gic_chip+0x0/0x74 Nov  5 17:31:31 swi..." />
<meta name="twitter:description" content="Hi,  We’re seeing an issue on our mangOH Red units that shutdown for unexplained reasons. Here is a crash log we were able to extract.  Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011285] irq 50, desc: cefdb000, depth: 0, count: 0, unhandled: 0 Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011308] -&gt;handle_irq():  c025ac68, msm_gpio_irq_handler+0x0/0x150 Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011338] -&gt;irq_data.chip(): c0ed8e68, gic_chip+0x0/0x74 Nov  5 17:31:31 swi..." />
<meta property="og:article:section" content="mangOH Red" />
<meta property="og:article:section:color" content="DF1E2E" />
<meta property="article:published_time" content="2018-11-05T19:38:37+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Qcpwrdn shut down issue on WP7603","mainEntity":{"@type":"Question","name":"Qcpwrdn shut down issue on WP7603","text":"Hi,\n\nWe’re seeing an issue on our mangOH Red units that shutdown for unexplained reasons. Here is a crash log we were able to extract.\n\nNov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011285] irq 50, desc: cefdb000, depth: 0, count: 0, unhandled: 0\n\nNov  5 17:31:31 swi-mdm9x28 user.warn kernel: &hellip;","upvoteCount":0,"answerCount":0,"dateCreated":"2018-11-05T19:38:37.007Z","author":{"@type":"Person","name":"ktanikel"}}}</script>
  </head>
  <body class="crawler ">
    <!--
<div id="navmenucontainer" class="container">
<div id="navmenuv">
    <ul class="nav">
      <li><a href="http://mangoh.io/">Project mangOH</a></li>
      <li><a href="http://mangoh.io/mango-green.html">mangOH Green</a></li>
      <li><a href="http://mangoh.io/buy-mangoh.html">Buy</a></li>
      <li><a href="http://mangoh.io/build-your-own.html">Build your own</a></li>
    </ul>
</div>
</div>
-->
    <header>
  <a href="/">
    mangOH forum
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="/t/qcpwrdn-shut-down-issue-on-wp7603/2075">Qcpwrdn shut down issue on WP7603</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.mangoh.io/c/mangoh-red/12" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #DF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>mangOH Red</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Qcpwrdn shut down issue on WP7603'>
        <meta itemprop='articleSection' content='mangOH Red'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='mangOH forum'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/284b9ca2de433d1cdfe5448455df1b398c8cc9c8.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/ktanikel'><span itemprop='name'>ktanikel</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-05T19:38:37Z' class='post-time'>
                    November 5, 2018,  7:38pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-05T19:42:58Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <p>Hi,</p>
<p>We’re seeing an issue on our mangOH Red units that shutdown for unexplained reasons. Here is a crash log we were able to extract.</p>
<pre><code>Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011285] irq 50, desc: cefdb000, depth: 0, count: 0, unhandled: 0
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011308] -&gt;handle_irq():  c025ac68, msm_gpio_irq_handler+0x0/0x150
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011338] -&gt;irq_data.chip(): c0ed8e68, gic_chip+0x0/0x74
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011361] -&gt;action():   (null)
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011372]    IRQ_NOPROBE set
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011383]  IRQ_NOREQUEST set
Nov  5 17:31:31 swi-mdm9x28 user.warn kernel: [   61.011394]   IRQ_NOTHREAD set
Nov  5 17:31:32 swi-mdm9x28 user.info kernel: [   62.443635] gpio_check_and_wake: wake-n_gpio26 STATE=WAKEUP
Nov  5 17:31:32 swi-mdm9x28 user.info kernel: [   62.465129] gpio_check_and_wake: wake-n_gpio26 STATE=SLEEP
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: qmi_at_unsol_ind_cb: ind id:33 
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: Received AT command forward request from modem
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: fwdcmd.opcode=1
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: fwdcmd.name=$QCPWRDN
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: fwdcmd.ntokens=0
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: ctrCond signalling complete.
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: Recieved ctrCond: p: 0, S:0, nr: 1
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: QCPWRDN has been detected
Nov  5 17:31:33 swi-mdm9x28 user.warn kernel: [   63.685455] PSM: Modem oprt mode - 3
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: sending QMI_AT_FWD_RESP_AT_CMD_RESP_V01 message
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: qmi_client_send_raw_msg_sync returned: 0
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: New request processing complete.
Nov  5 17:31:33 swi-mdm9x28 user.info swiapp: Waiting for ctrCond
Nov  5 17:31:33 swi-mdm9x28 daemon.info init: starting pid 1755, tty '': '/etc/init.d/rcK'
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.872044] gpio_check_and_wake: wake-n_gpio26 STATE=WAKEUP
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.879719] swimcu_device_init: start 0x7ff
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.883297] swimcu_device_init: mcufw ver=2.009 target=1 opt=0xF
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.887979] swimcu_device_init: success
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.895223] swimcu_set_fault_mask: 0x100, cnt 1
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.895241] swimcu reset_recovery: complete
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.895250] swimcu_set_reset_source: 0x40
Nov  5 17:31:33 swi-mdm9x28 user.info kernel: [   63.895271] gpio_check_and_wake: wake-n_gpio26 STATE=SLEEP
</code></pre>
<p>Does anyone know what QCPWRDN means, and why it would cause a random shutdown?</p>
<p>cm info details:</p>
<pre><code>root@swi-mdm9x28:~# cm info
Device:                        WP7603-1
IMEI:                          351711090107910
IMEISV:                        4
FSN:                           WD752585161410
Firmware Version:              SWI9X07Y_02.16.02.00 000000 jenkins 2018/04/19 19:59:02
Bootloader Version:            SWI9X07Y_02.16.02.00 000000 jenkins 2018/04/19 19:59:02
MCU Version:                   002.009
PRI Part Number (PN):          9907595
PRI Revision:                  001.004 
Carrier PRI Name:              GENERIC
Carrier PRI Revision:          002.032_000
SKU:                           1103727
Last Reset Cause:              Power Down
Resets Count:                  Expected: 248    Unexpected: 2
</code></pre>
<p>Legato version</p>
<pre><code>root@swi-mdm9x28:~# legato version
18.06.1_302932300e810a4fb0cba7b4960af4fd</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/rkirk'><span itemprop='name'>rkirk</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-07T18:51:28Z' class='post-time'>
                    November 7, 2018,  6:51pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-07T18:51:28Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="/u/ktanikel">@ktanikel</a>,</p>
<p>As you’ve identified, the source of the shutdown is the $QCPWRDN command which coordinates the system power down routine.  This isn’t something I’ve seen before, without a trigger, so to understand your platform a bit better:</p>
<ol>
<li>Do you have any custom applications?  If you have any custom apps that are triggering Ultra-Low power mode or PSM, those could be the triggers for the coordinated shutdown behaviour.</li>
<li>Is the timing consistent?  Log shows ~60 seconds - is this always true?</li>
<li>Is there a USB host connection?  If so, can you disconnect that and use only the UART console to communicate with the device temporarily?  In that configuration, is the power down still occurring (i.e. removing any host-supplied commands to determine if the origin is host or on-target).</li>
</ol>
<p>Those are the first things that come to mind.</p>
<p>Ryan</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/ktanikel'><span itemprop='name'>ktanikel</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-07T20:02:03Z' class='post-time'>
                    November 7, 2018,  8:02pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-07T20:02:03Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thank you for your reply Ryan.</p>
<p>To address your questions</p>
<ol>
<li>
<p>Yes, we have a custom application that uses ULPM. We set GPIO36 and a timer as boot sources before entering ULPM. However, the problem reported here seems to occur outside of our custom application control i.e. something else is initiating the shutdown and we’re trying to understand what that could be. Here’s what the log looks like when our applications triggers low power mode.</p>
<p>Nov  7 19:13:03 swi-mdm9x28 user.warn kernel: [  950.204461] PSM: Server Healthcheck timerid : 2136631240<br>
Nov  7 19:13:03 swi-mdm9x28 user.warn kernel: [  950.204552] PSM: Supported: 0<br>
Nov  7 19:13:03 swi-mdm9x28 user.warn kernel: [  950.205951] PSM: Client health check timerid : 808896<br>
Nov  7 19:13:03 swi-mdm9x28 user.debug kernel: [  950.206227] gpio-200 (sysfs): gpiod_request: status -16<br>
Nov  7 19:13:03 swi-mdm9x28 user.err kernel: [  950.207474] i2c-msm-v2 78b8000.i2c: NACK: slave not responding, ensure its powered: msgs(n:1 cur:0 tx) bc(rx:0 tx:18) mode:FIFO slv_addr:0x3a MSTR_STS:0x0c$300c8 OPER:0x00000090<br>
<strong>Nov  7 19:13:03 swi-mdm9x28 user.info kernel: [  950.243739] swimcu_mdm_sec_to_mcu_time_ms: mdm time=43200 seconds to be calibrated 500/489</strong><br>
Nov  7 19:13:03 swi-mdm9x28 user.info kernel: [  950.243766] swimcu_mdm_sec_to_mcu_time_ms: mcu time 44171000 ms + remainder time 44171 ms = 44215171 ms<br>
Nov  7 19:13:03 swi-mdm9x28 user.info kernel: [  950.253472] pm_set_mcu_ulpm_enable: sending wait_time_config<br>
Nov  7 19:13:03 swi-mdm9x28 user.info kernel: [  950.265234] swimcu_pm_data_store: sending persistent data to MCU<br>
Nov  7 19:13:03 swi-mdm9x28 user.info kernel: [  950.277847] pm_set_mcu_ulpm_enable: sending ulpm_config<br>
Nov  7 19:13:03 swi-mdm9x28 user.warn kernel: [  950.288790] PSM: Supported: 0<br>
Nov  7 19:13:03 swi-mdm9x28 daemon.info init: starting pid 3760, tty ‘’: ‘/etc/init.d/rcK’<br>
Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: subsystem_control_shutdown<br>
Nov  7 19:13:03 swi-mdm9x28 user.err qmi_shutdown_modem: QMUXD: WARNING qmi_qmux_if_pwr_up_init failed! rc=-6<br>
Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: Initialize QMI DMS Client<br>
Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: Current Modem status - 0<br>
<strong>Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: Move modem status to LPM<br>
Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: Wait for modem LPM complete</strong><br>
Nov  7 19:13:03 swi-mdm9x28 user.debug Legato:  DBUG | ampmanager[822]/ampManagerComponent T=main | ampManagerComponent.cpp dataConnectionStateHandlerFunc() 153 | Data connection state event received: 0<br>
Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: DMS indication id - 1<br>
<strong>Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: Modem in LPM state… proceed with rest of shutdown procedure<br>
Nov  7 19:13:03 swi-mdm9x28 user.info qmi_shutdown_modem: In the shutdown path<br>
Nov  7 19:13:03 swi-mdm9x28 user.warn kernel: [  950.716868] PSM: Modem oprt mode - 1</strong><br>
Nov  7 19:13:03 swi-mdm9x28 user.err Legato: =ERR= | posDaemon[914]/posDaemon T=main | le_pos.c ComputeMove() 663 | Longitude or Latitude are not relevant<br>
Nov  7 19:13:03 swi-mdm9x28 user.warn Legato: -WRN- | posDaemon[914]/le_pa_gnss T=unknown | pa_gnss_qmi.c PositionHandler() 1359 | Bad position indication<br>
Nov  7 19:13:03 swi-mdm9x28 user.warn Legato: -WRN- | modemDaemon[900]/le_pa T=main | pa_sim_qmi.c MapSimState() 879 | More than one application 2<br>
Nov  7 19:13:04 swi-mdm9x28 user.info qmi_shutdown_modem: Received subsystem shutdown complete in 3 second(s)<br>
Nov  7 19:13:04 swi-mdm9x28 user.info qmi_shutdown_modem: Success.<br>
Nov  7 19:13:04 swi-mdm9x28 user.info qmi_shutdown_modem: Modem shutdown complete<br>
Nov  7 19:13:04 swi-mdm9x28 user.warn kernel: [  951.267980] Stopping QCMAP_ConnectionManager:<br>
Nov  7 19:13:04 swi-mdm9x28 user.warn kernel: [  951.404030] Stopping qti: done</p>
</li>
</ol>
<p>As you can see, the boot sources are being set and log clearly indicates it is going in to a LPM state. Also, there seems to some difference with respect to “Modem oprt mode” going to -3 in the problem condition vs -1 in the normal operation. I don’t know what the significance of that is.</p>
<ol start="2">
<li>I don’t have enough information on this yet. We’ve only been able to capture the log once which is what you see above. I’ll update as we got more data.</li>
<li>There is no USB host connection. The device is running on an internal battery and is also connected to an external power supply.</li>
</ol>
<p>We haven’t yet found the exact conditions to reproduce this problem. However, we have several devices out in production that are exhibiting this behavior so we’re trying to address this as best we can with the information at hand.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/ajoseph'><span itemprop='name'>ajoseph</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-13T19:30:10Z' class='post-time'>
                    November 13, 2018,  7:30pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-13T19:30:10Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="/u/ktanikel">@ktanikel</a><br>
Do you have "“logread -f” for the shutdown scenario? The logs could help identify the trigger for the shutdown.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/ktanikel'><span itemprop='name'>ktanikel</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-14T17:41:05Z' class='post-time'>
                    November 14, 2018,  5:41pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-14T17:41:05Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="/u/ajoseph">@ajoseph</a><br>
We don’t have the output of "logread -f " because we’ve never encountered this problem during development or testing with the USB connected. The problem seems to occur when the unit is operating off a battery and the only logs we can get are /mnt/flash/legato_logs/, which is what I’ve posted here. As per my understanding, ‘logread’ gets written to legato_logs when there is crash, so what you’re seeing here is essentially logread.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/ajoseph'><span itemprop='name'>ajoseph</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-14T19:24:33Z' class='post-time'>
                    November 14, 2018,  7:24pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-14T19:24:33Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This scenario looks like an organized shutdown. The “$QCPWRDN” is the final command which actually shutdown the modem, but the trigger itself is somewhere else. Legato logs leading up to “$QCPWRDN” being called may provide an idea as to what the trigger is.</p>
<p>Logs for the app is stored in case of an application crash at /mnt/flash/legato_logs/. <a href="https://docs.legato.io/latest/c_logging.html#c_log_debugFiles" rel="nofollow noopener">https://docs.legato.io/latest/c_logging.html#c_log_debugFiles</a>. To ensure Legato logs are captured(which should show the trigger), you will have to redirect “logread -f” to a file (by running script at startup) or modifying syslogd to store logs to a fie.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/liamodonnell'><span itemprop='name'>liamodonnell</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/qcpwrdn-shut-down-issue-on-wp7603/2075">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-07-19T08:48:30Z' class='post-time'>
                    July 19, 2022,  8:48am
                  </time>
                  <meta itemprop='dateModified' content='2022-07-19T08:48:30Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hello <a class="mention" href="/u/ktanikel">@ktanikel</a>,</p>
<p>Did you ever resolve this issue?</p>
<p>I’ve just started seeing this issue today, and was fortunate enough to grab logread -f.</p>
<pre><code class="lang-auto">Jul 19 08:20:45 swi-mdm9x28-wp user.info kernel: [ 4060.782706] gpio_check_and_wake: wake-n_gpio26 STATE=SLEEP
Jul 19 08:20:45 swi-mdm9x28-wp user.info Legato:  INFO | core[894]/coreComponent T=main | Core.cpp Button2Callback() 59 | Button 2 Released (HIGH).
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.135092] gpio_check_and_wake: wake-n_gpio26 STATE=WAKEUP
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.145137] swimcu_device_init: start 0xfff
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.145157] swimcu_device_init: start 0xfff
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.149619] swimcu_device_init: mcufw ver=2.011 target=1 opt=0xF
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.158717] swimcu_device_init: device init success
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.158745] swimcu_gpio_refresh
Jul 19 08:20:46 swi-mdm9x28-wp user.info Legato:  INFO | dcsDaemon[875]/dcsCellular T=main | dcsCellular.c DcsCellularConnEventStateHandler() 257 | State of connection 1 transitioned from up to down
Jul 19 08:20:46 swi-mdm9x28-wp user.info Legato:  INFO | modem[897]/modemComponent T=main | Modem.cpp ConnectionStateHandler() 262 | Interface: .
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.212147] swimcu_set_fault_mask: 0x100, cnt 1
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.212170] swimcu_reset_recovery: swimcu_reset_recovery complete
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.212184] swimcu_set_reset_source: 0x40
Jul 19 08:20:46 swi-mdm9x28-wp user.info kernel: [ 4061.212210] gpio_check_and_wake: wake-n_gpio26 STATE=SLEEP
Jul 19 08:20:46 swi-mdm9x28-wp user.err Legato: =ERR= | modemDaemon[880]/le_pa T=main | pa_mrc_qmi.c pa_mrc_GetCurrentNetwork() 2921 | Cannot retrieve current Network information.
Jul 19 08:20:46 swi-mdm9x28-wp user.info Legato:  INFO | modem[897]/modemComponent T=main | Modem.cpp ConnectionStateHandler() 284 | Data state is disconnected.
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: qmi_at_unsol_ind_cb: ind id:33
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: Received AT command forward request from modem
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: fwdcmd.opcode=1
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: fwdcmd.name=$QCPWRDN
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: fwdcmd.ntokens=0
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: ctrCond signalling complete.
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: Recieved ctrCond: p: 0, S:0, nr: 1
Jul 19 08:20:46 swi-mdm9x28-wp user.info swiapp: QCPWRDN has been detected
Jul 19 08:20:46 swi-mdm9x28-wp user.warn kernel: [ 4061.259674] PSM: Modem oprt mode - 3
</code></pre>
<p>I do not use ulpm, so unless one of the built in applications is sending my device to sleep, I am not sure what is causing this to happen.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
