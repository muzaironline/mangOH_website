<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CAN IoT Card driver - #30 by raxsix - mangOH Red - mangOH forum</title>
    <meta name="description" content="Hello, 
I got  this CAN module 
http://www.taloncom.com/images/Talon%20mangOH%20CAN%20Bus%20Module%20Brief%202016.pdf 
Is this the right tutorial for MangOH Red in order to get this CAN module to work?">
    <meta name="generator" content="Discourse 3.2.0.beta2-dev - https://github.com/discourse/discourse version 11176407155714e2ebc3885a5f3301a2b4d37c5b">
<link rel="icon" type="image/png" href="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/c8f691ef20d8b5ee5eb3e88daa9a37267fd8b5c6_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/c9436805837dffdd4ff80102c98ca366d74fee66_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://forum.mangoh.io/t/can-iot-card-driver/997?page=2" />

<link rel="search" type="application/opensearchdescription+xml" href="https://forum.mangoh.io/opensearch.xml" title="mangOH forum Search">

    <link href="https://sea2.discourse-cdn.com/business6/stylesheets/color_definitions_mangoh-color-scheme_1_1_22c40ac3b958048f5d2773ba7c6e0a583de42cca.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/checklist_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-adplugin_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-adplugin"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-akismet_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-akismet"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-cakeday_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-data-explorer_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-data-explorer"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-details_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-footnote_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-footnote"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-lazy-videos_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-local-dates_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-narrative-bot_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-policy_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-policy"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-post-voting_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-post-voting"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-presence_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-solved_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-solved"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-spoiler-alert_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-spoiler-alert"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-templates_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-templates"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-topic-voting_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/hosted-site_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="hosted-site"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/poll_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-post-voting_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-post-voting_desktop"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-topic-voting_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/poll_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/desktop_theme_1_ab9b3e277688d87911f25cd6e1b20eb3d4321381.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="1" data-theme-name="mangoh"/>

    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-718568-6" data-json="{&quot;cookieDomain&quot;:&quot;mangoh.io&quot;}" data-auto-link-domains="">

  <link rel="preload" href="https://global.discourse-cdn.com/business6/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.br.js" as="script">
<script defer src="https://global.discourse-cdn.com/business6/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.br.js"></script>


        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;CAN IoT Card driver&#39;" href="https://forum.mangoh.io/t/can-iot-card-driver/997.rss" />
    <meta property="og:site_name" content="mangOH forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/3a6474224b6583b6512ef6a5cd02d7d66cc320b7.png" />
<meta property="og:image" content="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/3a6474224b6583b6512ef6a5cd02d7d66cc320b7.png" />
<meta property="og:url" content="https://forum.mangoh.io/t/can-iot-card-driver/997/30" />
<meta name="twitter:url" content="https://forum.mangoh.io/t/can-iot-card-driver/997/30" />
<meta property="og:title" content="CAN IoT Card driver" />
<meta name="twitter:title" content="CAN IoT Card driver" />
<meta property="og:description" content="Finally, saw the can0 line with ifconfig command after all those steps:  echo 2 &gt; /sys/class/gpio/export  echo out  &gt; /sys/class/gpio/gpio2/direction  echo 1  &gt; /sys/class/gpio/gpio2/value  // Enable level shifter on the CAN IoT card  echo 13 &gt; /sys/class/gpio/export  echo out  &gt; /sys/class/gpio/gpio13/direction  echo 1  &gt; /sys/class/gpio/gpio13/value  modprobe can  modprobe can-dev  modprobe can-raw  modprobe mcp251x  ip link set can0 type can bitrate 125000 triple-sampling on  ifconfig can0 up ..." />
<meta name="twitter:description" content="Finally, saw the can0 line with ifconfig command after all those steps:  echo 2 &gt; /sys/class/gpio/export  echo out  &gt; /sys/class/gpio/gpio2/direction  echo 1  &gt; /sys/class/gpio/gpio2/value  // Enable level shifter on the CAN IoT card  echo 13 &gt; /sys/class/gpio/export  echo out  &gt; /sys/class/gpio/gpio13/direction  echo 1  &gt; /sys/class/gpio/gpio13/value  modprobe can  modprobe can-dev  modprobe can-raw  modprobe mcp251x  ip link set can0 type can bitrate 125000 triple-sampling on  ifconfig can0 up ..." />
<meta property="og:article:section" content="mangOH Red" />
<meta property="og:article:section:color" content="DF1E2E" />
<meta property="article:published_time" content="2018-03-08T16:59:44+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="/t/can-iot-card-driver/997">
        <link rel="next" href="/t/can-iot-card-driver/997?page=3">

    
  </head>
  <body class="crawler ">
    <!--
<div id="navmenucontainer" class="container">
<div id="navmenuv">
    <ul class="nav">
      <li><a href="http://mangoh.io/">Project mangOH</a></li>
      <li><a href="http://mangoh.io/mango-green.html">mangOH Green</a></li>
      <li><a href="http://mangoh.io/buy-mangoh.html">Buy</a></li>
      <li><a href="http://mangoh.io/build-your-own.html">Build your own</a></li>
    </ul>
</div>
</div>
-->
    <header>
  <a href="/">
    mangOH forum
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="/t/can-iot-card-driver/997">CAN IoT Card driver</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.mangoh.io/c/mangoh-red/12" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #DF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>mangOH Red</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='CAN IoT Card driver'>
        <meta itemprop='articleSection' content='mangOH Red'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='mangOH forum'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/284b9ca2de433d1cdfe5448455df1b398c8cc9c8.png'>
          </div>
      </div>

          <div id='post_25' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/asyal'><span itemprop='name'>asyal</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-26T23:43:56Z' class='post-time'>
                    January 26, 2018, 11:43pm
                  </time>
                  <meta itemprop='dateModified' content='2018-01-26T23:43:56Z'>
              <span itemprop='position'>25</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I ran into the same issues you did and will work on resolving it next week.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_26' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-27T08:12:30Z' class='post-time'>
                    January 27, 2018,  8:12am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-27T08:12:30Z'>
              <span itemprop='position'>26</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thank’s a lot for your help.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_27' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/raxsix'><span itemprop='name'>raxsix</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-28T18:04:51Z' class='post-time'>
                    January 28, 2018,  6:04pm
                  </time>
                  <meta itemprop='dateModified' content='2018-01-28T18:04:51Z'>
              <span itemprop='position'>27</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <ol start="9">
<li>Reflash new image with CAN driver module support to the target board<br>
FDT command: fdt yocto_wp85.cwe</li>
</ol>
<p>When I run it I get: <strong>command not found: fdt</strong><br>
What do I need?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_28' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-29T05:18:40Z' class='post-time'>
                    January 29, 2018,  5:18am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-29T05:18:40Z'>
              <span itemprop='position'>28</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Use :<br>
cfglegato<br>
fwupdate download yocto_wp85.cwe 192.168.2.2</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="2" />
              </div>

          </div>
          <div id='post_29' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/raxsix'><span itemprop='name'>raxsix</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-29T19:57:23Z' class='post-time'>
                    January 29, 2018,  7:57pm
                  </time>
                  <meta itemprop='dateModified' content='2018-01-29T19:57:23Z'>
              <span itemprop='position'>29</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks, Francis, I got one step closer but I am a bit confused about next one. When should I remove the card and how? I tried different ways but<br>
<strong>echo 2 &gt; /sys/class/gpio/export</strong><br>
gives me<br>
<strong>sh: write error: Device or resource busy</strong></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_30' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/raxsix'><span itemprop='name'>raxsix</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-08T16:59:44Z' class='post-time'>
                    March 8, 2018,  4:59pm
                  </time>
                  <meta itemprop='dateModified' content='2018-03-08T16:59:44Z'>
              <span itemprop='position'>30</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Finally, saw the can0 line with ifconfig command after all those steps:</p>
<p>echo 2 &gt; /sys/class/gpio/export<br>
echo out  &gt; /sys/class/gpio/gpio2/direction<br>
echo 1  &gt; /sys/class/gpio/gpio2/value</p>
<p>// Enable level shifter on the CAN IoT card<br>
echo 13 &gt; /sys/class/gpio/export<br>
echo out  &gt; /sys/class/gpio/gpio13/direction<br>
echo 1  &gt; /sys/class/gpio/gpio13/value</p>
<p>modprobe can<br>
modprobe can-dev<br>
modprobe can-raw<br>
modprobe mcp251x<br>
ip link set can0 type can bitrate 125000 triple-sampling on<br>
ifconfig can0 up</p>
<p><strong>And after restarting MangOH red board I can not get it up and running again, why?</strong><br>
cannot find device “can0”</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://forum.mangoh.io/t/can-bus-read-and-filter/1262/3">CAN-bus read and filter</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
          <div id='post_31' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-21T21:08:01Z' class='post-time'>
                    March 21, 2018,  9:08pm
                  </time>
                  <meta itemprop='dateModified' content='2018-03-21T21:08:01Z'>
              <span itemprop='position'>31</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hello</p>
<p>You must start a script who intialize the CAN.<br>
You can do that at startup or include this script into your application.</p>
<p>In your project create a folder “script” , inside create a file “can_init.sh”</p>
<p>copy/paste this code into “can_init.sh”</p>
<p>#!/bin/sh</p>
<p>export PATH=$PATH:/sbin</p>
<p>ifconfig can0 down</p>
<p>echo 2 &gt; /sys/class/gpio/export</p>
<p>echo out  &gt; /sys/class/gpio/gpio2/direction</p>
<p>echo 1  &gt; /sys/class/gpio/gpio2/value</p>
<p>echo 13 &gt; /sys/class/gpio/export &amp;&amp;</p>
<p>echo out  &gt; /sys/class/gpio/gpio13/direction &amp;&amp;</p>
<p>echo 1  &gt; /sys/class/gpio/gpio13/value &amp;&amp;</p>
<p>modprobe can &amp;&amp;</p>
<p>sleep 1 &amp;&amp;</p>
<p>modprobe can-dev &amp;&amp;</p>
<p>sleep 1 &amp;&amp;</p>
<p>modprobe can-raw &amp;&amp;</p>
<p>sleep 1 &amp;&amp;</p>
<p>modprobe mcp251x &amp;&amp;</p>
<p>sleep 1</p>
<p>CAN=<code>ifconfig | cut -c -4 | sed 's/^\s\+//' | sort | uniq | grep can0</code></p>
<p>if [ -z “$CAN” ]; then</p>
<pre><code>ip link set can0 type can bitrate 500000 triple-sampling on &amp;&amp;

sleep 1 &amp;&amp;

ifconfig can0 up
</code></pre>
<p>fi</p>
<p>In your app create this function :</p>
<p><span class="hashtag">#include</span> &lt;net/if.h&gt;<br>
<span class="hashtag">#include</span> &lt;sys/ioctl.h&gt;<br>
<span class="hashtag">#include</span> &lt;linux/can.h&gt;<br>
<span class="hashtag">#include</span> &lt;linux/can/raw.h&gt;<br>
<span class="hashtag">#include</span> &lt;sys/types.h&gt;<br>
<span class="hashtag">#include</span> &lt;sys/socket.h&gt;<br>
<span class="hashtag">#include</span> &lt;stdio.h&gt;<br>
<span class="hashtag">#include</span> &lt;string.h&gt;<br>
<span class="hashtag">#include</span> &lt;unistd.h&gt;<br>
<span class="hashtag">#include</span> &lt;fcntl.h&gt;</p>
<p><span class="hashtag">#define</span> INTERFACE_NAME_SIZE 15</p>
<p><span class="hashtag">#define</span> SOCKET_ERROR 		1<br>
<span class="hashtag">#define</span> SOCK_IOCTL_ERROR	2<br>
<span class="hashtag">#define</span> SOCK_BINDING_ERROR 	3<br>
<span class="hashtag">#define</span> SOCK_WRITING_ERROR 	4<br>
<span class="hashtag">#define</span> SOCK_READING_ERROR 	5<br>
<span class="hashtag">#define</span> WRONG_DLC			6<br>
<span class="hashtag">#define</span> WRONG_ID 			7</p>
<p>int bitrate;<br>
int sdw;					// socket descriptor write<br>
int sdr;					// socket descriptor read<br>
int nbytesReceive;<br>
bool canwrite;<br>
char name[INTERFACE_NAME_SIZE];<br>
struct can_frame frameRead;<br>
struct can_frame frameWrite;</p>
<p>int can_connect(const char *interface)<br>
{<br>
struct sockaddr_can addr;<br>
struct ifreq ifr;<br>
int sock_buf_size;</p>
<pre><code>sock_buf_size = 1000;


// Run the can-init.sh before advertising the service to ensure that the CAN device is
// available before we allow it to be used.
char line[256];
FILE* fp = popen("can_init.sh 2&gt;&amp;1", "r");
LE_ASSERT(fp != NULL);
while (fgets(line, sizeof(line), fp) != NULL)
{
	LE_INFO("can_init.sh output: %s", line);
}
int canInitResult = pclose(fp);
LE_FATAL_IF(!WIFEXITED(canInitResult), "Could not run can_init.sh");
const int canInitExitCode = WEXITSTATUS(canInitResult);
LE_FATAL_IF(canInitExitCode != 0, "can_init.sh failed with exit code %d", canInitExitCode);


// if interface string is long we will cut it
if(strlen(interface)&gt;INTERFACE_NAME_SIZE)
{
	memcpy(name,interface,INTERFACE_NAME_SIZE);
	name[INTERFACE_NAME_SIZE-1]='\0';
}
else
{
	strcpy(name,interface);
}

// SOCKET FOR READING
if ((sdr = socket(PF_CAN, SOCK_RAW, CAN_RAW)) &lt; 0)
{
	return SOCKET_ERROR;
}

addr.can_family = PF_CAN;

strcpy(ifr.ifr_name, name);
if (ioctl(sdr, SIOCGIFINDEX, &amp;ifr) &lt; 0)
{
	return SOCK_IOCTL_ERROR;
}

addr.can_ifindex = ifr.ifr_ifindex;


if (bind(sdr, (struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0)
{
	return SOCK_BINDING_ERROR;
}

// Filter
struct can_filter rfilter[7]; int i = 0;
rfilter[i].can_id  = CHG_TX_STS;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
rfilter[i].can_id   = CHG_TX_ACT;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
rfilter[i].can_id   = BMS_CHRGR_CTL;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
rfilter[i].can_id   = BMS_SOC_DATA;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
rfilter[i].can_id   = BMS_BATTP_DATA;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
rfilter[i].can_id   = BMS_BATP_DATA;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
rfilter[i].can_id   = BMS_BATU_DATA;
rfilter[i].can_mask = CAN_SFF_MASK | CAN_EFF_FLAG | CAN_RTR_FLAG; i++;
setsockopt(sdr, SOL_CAN_RAW, CAN_RAW_FILTER, &amp;rfilter, sizeof(rfilter));

// SET SOCKET BUFFER SIZE
setsockopt(sdr, SOL_CAN_RAW, SO_RCVBUF, (char *)&amp;sock_buf_size, sizeof(sock_buf_size));

// SOCKET FOR WRITING
if ((sdw = socket(PF_CAN, SOCK_RAW, CAN_RAW)) &lt; 0)
{
	return SOCKET_ERROR;
}
addr.can_family = PF_CAN;

strcpy(ifr.ifr_name, name);
if (ioctl(sdw, SIOCGIFINDEX, &amp;ifr) &lt; 0)
{
	return SOCK_IOCTL_ERROR;
}
addr.can_ifindex = ifr.ifr_ifindex;


if (bind(sdw, (struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0)
{
	return SOCK_BINDING_ERROR;
}

// SET SOCKET BUFFER SIZE
setsockopt(sdw, SOL_CAN_RAW, SO_SNDBUF, (char *)&amp;sock_buf_size, sizeof(sock_buf_size));

//READ SOCKET NON-BLOCKING
int flags;
if (-1 == (flags = fcntl(sdr, F_GETFL, 0))) flags = 0;
fcntl(sdr, F_SETFL, flags | O_NONBLOCK);

return 0;
</code></pre>
<p>}</p>
<p>int can_disconnect(void)<br>
{<br>
close(sdw);<br>
close(sdr);<br>
return 0;<br>
}</p>
<p>int can_send(void)<br>
{<br>
int nbytesWrite;</p>
<pre><code>// USE SEND STANDARD FRAME
frameWrite.can_id = 0x600;
frameWrite.can_id &amp;= CAN_SFF_MASK;

frameWrite.can_dlc = 8;
strcpy((char *)frameWrite.data, "MangoH  ");

if ((nbytesWrite = write(sdw, &amp;frameWrite, sizeof(frameWrite))) != sizeof(frameWrite))
{
    canwrite = false;
    LE_INFO ("Writing error");
	return SOCK_WRITING_ERROR;
}


canwrite = true;
return 0;
</code></pre>
<p>}</p>
<p>int can_receive(void)<br>
{<br>
nbytesReceive = 1;<br>
while (nbytesReceive != 0)<br>
{<br>
if ((nbytesReceive = read(sdr, &amp;frameRead, sizeof(frameRead))) != sizeof(frameRead))<br>
{<br>
return SOCK_READING_ERROR;<br>
}<br>
/<em>else<br>
LE_INFO(“Receive message %X %X %X %X %X %X %X %X %X”, frameRead.can_id, frameRead.data[0], frameRead.data[1], frameRead.data[2], frameRead.data[3]<br>
, frameRead.data[4], frameRead.data[5], frameRead.data[6], frameRead.data[7]);</em>/<br>
}</p>
<pre><code>return 0;
</code></pre>
<p>}</p>
<p>You just now to call it in your main :</p>
<p>COMPONENT_INIT<br>
{<br>
can_connect(“can0”);<br>
can_send();<br>
can_receive();</p>
<p>}</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_32' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-21T21:15:18Z' class='post-time'>
                    March 21, 2018,  9:15pm
                  </time>
                  <meta itemprop='dateModified' content='2018-03-21T21:15:18Z'>
              <span itemprop='position'>32</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Dont forget  :</p>
<p>to run can_init.sh as a Linux script :</p>
<p>chmod 755 can_init.sh</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="2" />
              </div>

          </div>
          <div id='post_33' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/raxsix'><span itemprop='name'>raxsix</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-22T08:01:06Z' class='post-time'>
                    March 22, 2018,  8:01am
                  </time>
                  <meta itemprop='dateModified' content='2018-03-22T08:01:06Z'>
              <span itemprop='position'>33</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I almost figured that one out,  I can use some of your suggested code, very helpful, thanks a lot.<br>
There’s one thing that I need to understand, what is the<br>
<strong>triple-sampling on</strong> ?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_34' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-22T08:35:10Z' class='post-time'>
                    March 22, 2018,  8:35am
                  </time>
                  <meta itemprop='dateModified' content='2018-03-22T08:35:10Z'>
              <span itemprop='position'>34</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I think it’s around the CAN SPI driver setting to sure that not lost can frame when you use SocketCAN.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_35' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/abrothman'><span itemprop='name'>abrothman</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-28T20:13:50Z' class='post-time'>
                    March 28, 2018,  8:13pm
                  </time>
                  <meta itemprop='dateModified' content='2018-03-28T20:13:50Z'>
              <span itemprop='position'>35</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/asyal">@asyal</a>,</p>
<p>Isn’t it about time to make a single, accurate, up-to-date guide to using CAN on a MangOH Red, with ALL of the CORRECT steps in ONE place, as well as a sample app?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_36' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/asyal'><span itemprop='name'>asyal</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-29T00:20:19Z' class='post-time'>
                    March 29, 2018, 12:20am
                  </time>
                  <meta itemprop='dateModified' content='2018-03-29T00:20:19Z'>
              <span itemprop='position'>36</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/abrothman">@abrothman</a>  yes, it is.<br>
We will look at providing a much more simpler way for this. Will work with our linux experts and find a more easier way on this .</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_37' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/sreesyratron'><span itemprop='name'>sreesyratron</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">

                <link itemprop="image" href="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/8b5742fb050968a86879c4d9fc8e396faea5a753.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-05-18T04:55:32Z' class='post-time'>
                    May 18, 2018,  4:55am
                  </time>
                  <meta itemprop='dateModified' content='2018-05-18T04:55:32Z'>
              <span itemprop='position'>37</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>HI Francis ,</p>
<p>Thanks for your source code.<br>
I was trying Talon CAN interface over MangoH red + WP7502 combo, it is giving me some error.<br>
Running legato version 16.10.4 . Source compile over Developer studio.</p>
<div class="md-table">
<table>
<thead>
<tr>
<th>Description</th>
<th>Resource</th>
<th>Path</th>
<th>Location</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Symbol ‘BMS_BATP_DATA’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 101</td>
<td>Semantic Error</td>
</tr>
<tr>
<td>Symbol ‘BMS_BATTP_DATA’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 99</td>
<td>Semantic Error</td>
</tr>
<tr>
<td>Symbol ‘BMS_BATU_DATA’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 103</td>
<td>Semantic Error</td>
</tr>
<tr>
<td>Symbol ‘BMS_CHRGR_CTL’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 95</td>
<td>Semantic Error</td>
</tr>
<tr>
<td>Symbol ‘BMS_SOC_DATA’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 97</td>
<td>Semantic Error</td>
</tr>
<tr>
<td>Symbol ‘CHG_TX_ACT’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 93</td>
<td>Semantic Error</td>
</tr>
<tr>
<td>Symbol ‘CHG_TX_STS’ could not be resolved</td>
<td>sreetestcanComponent.c</td>
<td>/sreetestcan/sreetestcanComponent</td>
<td>line 91</td>
<td>Semantic Error</td>
</tr>
</tbody>
</table>
</div><p>Also attaching the screenshot of my developer studio compiler error.</p>
<p>Please let me know which header file contain CHG parameters ??<br>
Can you share your whole project directory ( developer studio ) ?</p>
<p>Thanks and Regards,<div class="lightbox-wrapper"><a class="lightbox" href="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/8b5742fb050968a86879c4d9fc8e396faea5a753.png" data-download-href="/uploads/short-url/jSFkbBxQi0hpNjsA6ySldhVaxF1.png?dl=1" title="CAN error.png" rel="nofollow noopener"><img src="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/8b5742fb050968a86879c4d9fc8e396faea5a753_2_690x387.png" alt="CAN%20error" data-base62-sha1="jSFkbBxQi0hpNjsA6ySldhVaxF1" width="690" height="387" srcset="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/8b5742fb050968a86879c4d9fc8e396faea5a753_2_690x387.png, https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/8b5742fb050968a86879c4d9fc8e396faea5a753_2_1035x580.png 1.5x, https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/8b5742fb050968a86879c4d9fc8e396faea5a753.png 2x" data-small-upload="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/8b5742fb050968a86879c4d9fc8e396faea5a753_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">CAN error.png</span><span class="informations">1366×768 165 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_38' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-05-21T09:43:43Z' class='post-time'>
                    May 21, 2018,  9:43am
                  </time>
                  <meta itemprop='dateModified' content='2018-05-21T09:43:43Z'>
              <span itemprop='position'>38</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hello</p>
<p>Ah this is define for message ID. It’s just a example. You can replace this message by your own message ID.</p>
<p>Regards,</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_39' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/asyal'><span itemprop='name'>asyal</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">

                <link itemprop="image" href="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/07ed688be6d6288a669778f65f7eccdd96770925.ico">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-06-22T12:34:35Z' class='post-time'>
                    June 22, 2018, 12:34pm
                  </time>
                  <meta itemprop='dateModified' content='2018-06-22T12:34:35Z'>
              <span itemprop='position'>39</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>hi <a class="mention" href="/u/abrothman">@abrothman</a> , we have simplified the experience<br>
<a href="https://github.com/mangOH/mangOH/wiki/Running-the-MCP2515-CAN-driver-for-mangOH-for-mangOH-Red" class="onebox" target="_blank" rel="nofollow noopener">https://github.com/mangOH/mangOH/wiki/Running-the-MCP2515-CAN-driver-for-mangOH-for-mangOH-Red</a></p>
<p>We will also hold a Google hangout on July 18th to walk you through the process on how we built it ground up</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_40' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-06-22T13:02:44Z' class='post-time'>
                    June 22, 2018,  1:02pm
                  </time>
                  <meta itemprop='dateModified' content='2018-06-22T13:02:44Z'>
              <span itemprop='position'>40</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks <a class="mention" href="/u/asyal">@asyal</a>.</p>
<p>I try it but I not have the mcp251x.ko into the build.</p>
<p>I follow instruction to update the git into the VM</p>
<p><span class="math"> cd ~/mangOH
</span> git pull &amp;&amp; git submodule update --init<br>
$ make red_wp76xx</p>
<p>The build is complete but the driver is not in the image…</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_41' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/asyal'><span itemprop='name'>asyal</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-06-22T13:11:32Z' class='post-time'>
                    June 22, 2018,  1:11pm
                  </time>
                  <meta itemprop='dateModified' content='2018-06-22T13:11:32Z'>
              <span itemprop='position'>41</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I think we just need to update the sdef. We will check and post the updated sdef later today. Anyways this will work for us and we just need to update a couple of things which we will do by end of the day.  <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_42' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-06-22T13:13:26Z' class='post-time'>
                    June 22, 2018,  1:13pm
                  </time>
                  <meta itemprop='dateModified' content='2018-06-22T13:13:26Z'>
              <span itemprop='position'>42</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Ok good !</p>
<p>can you send  me the driver (.ko) for wp76 to my email box ?</p>
<p>I will test it</p>
<p><a href="mailto:francis.duhaut@fr.enersys.com">francis.duhaut@fr.enersys.com</a></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_43' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Francis.duhaut'><span itemprop='name'>Francis.duhaut</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-06-26T09:39:15Z' class='post-time'>
                    June 26, 2018,  9:39am
                  </time>
                  <meta itemprop='dateModified' content='2018-06-26T09:39:15Z'>
              <span itemprop='position'>43</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/asyal">@asyal</a> can you provide me the sdef file or modification to do ?</p>
<p>Thanks</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_44' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Naej'><span itemprop='name'>Naej</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/can-iot-card-driver/997">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-28T12:35:16Z' class='post-time'>
                    March 28, 2019, 12:35pm
                  </time>
                  <meta itemprop='dateModified' content='2019-03-28T12:35:16Z'>
              <span itemprop='position'>44</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi,<br>
I got a mangOH red board with the Talon CAN IoT board. Is there a simple (working ;-]) read example? I’ve tried the <a class="mention" href="/u/francis.duhaut">@Francis.duhaut</a> code and it won’t compile. I also tried the KillSwitch Example compile but did not works. So I made a simple read code:</p>
<p><span class="hashtag">#include</span> “legato.h”<br>
<span class="hashtag">#include</span> “interfaces.h”</p>
<p><span class="hashtag">#include</span> &lt;stdio.h&gt;<br>
<span class="hashtag">#include</span> &lt;string.h&gt;<br>
<span class="hashtag">#include</span> &lt;fcntl.h&gt;<br>
<span class="hashtag">#include</span> &lt;sys/ioctl.h&gt;<br>
<span class="hashtag">#include</span> &lt;net/if.h&gt;<br>
<span class="hashtag">#include</span> &lt;linux/can.h&gt;<br>
<span class="hashtag">#include</span> &lt;linux/can/raw.h&gt;</p>
<p>int soc;<br>
int read_can_port;</p>
<p>int open_port(const char *port)<br>
{<br>
struct ifreq ifr;<br>
struct sockaddr_can addr;</p>
<pre><code>/* open socket */
soc = socket(PF_CAN, SOCK_RAW, CAN_RAW);
if(soc &lt; 0)
{
    return (-1);
}

addr.can_family = AF_CAN;
strcpy(ifr.ifr_name, port);

if (ioctl(soc, SIOCGIFINDEX, &amp;ifr) &lt; 0)
{

    return (-1);
}

addr.can_ifindex = ifr.ifr_ifindex;

fcntl(soc, F_SETFL, O_NONBLOCK);

if (bind(soc, (struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0)
{

    return (-1);
}
LE_INFO("CAN Is Set");
return 0;
</code></pre>
<p>}</p>
<p>void read_port()<br>
{<br>
LE_INFO(“Enter Read Function”);<br>
struct can_frame frame_rd;<br>
int recvbytes = 0;</p>
<pre><code>read_can_port = 1;
while(read_can_port)
{
    printf("Read ... recv:%d\n", recvbytes);
    struct timeval timeout = {1, 0};
    
    fd_set readSet;
    FD_ZERO(&amp;readSet);
    FD_SET(soc, &amp;readSet);

    if (select((soc + 1), &amp;readSet, NULL, NULL, &amp;timeout) &gt;= 0)
    {
        if (!read_can_port)
        {
            LE_INFO("Nothing Received");
            break;
        }
        if (FD_ISSET(soc, &amp;readSet))
        {
            LE_INFO("Something Received");
            recvbytes = read(soc, &amp;frame_rd, sizeof(struct can_frame));
            if(recvbytes)
            {
                LE_INFO("Can Received");
                printf("dlc = %d, data = %s\n", frame_rd.can_dlc,frame_rd.data);

            }
        }
    }

}
</code></pre>
<p>}</p>
<p>int close_port()<br>
{<br>
close(soc);<br>
return 0;<br>
}</p>
<p>COMPONENT_INIT<br>
{<br>
LE_INFO(“Open Port”);<br>
open_port(“can0”);<br>
LE_INFO(“Close Port”);<br>
close_port();<br>
LE_INFO(“ReOpen Port”);<br>
open_port(“can0”);<br>
LE_INFO(“Read CAN”);<br>
read_port();<br>
LE_INFO(“Quit App”);<br>
}</p>
<p>It compile, I launch the shell script before running app but i got this error:</p>
<p>swi-mdm9x28-wp user.notice kernel: [   96.220890] audit: type=1400 audit(315964898.251:4): lsm=SMACK fn=smack_inode_getattr action=denied subject=“app.testCan” object=“admin” requested=r pid=1952 comm=“testCan” path=“pipe:[9211]” dev=“pipefs” ino=9211</p>
<p>Any Idea on what appends? Or better a simple working example? Does someone have reached add a can-utils layer in the yocto configuration? It also lacks a lot of documentation about it.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://forum.mangoh.io/t/bootstrap-can-bus-application/2487/2">Bootstrap CAN Bus application</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
    </div>

    <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
        <span itemprop='name'><a rel="prev" itemprop="url" href="/t/can-iot-card-driver/997">← previous page</a></span>
        <span itemprop='name'><b><a rel="next" itemprop="url" href="/t/can-iot-card-driver/997?page=3">next page →</a></b></span>
    </div>





    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
