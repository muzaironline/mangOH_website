<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Poor Signal Quality and Air Vantage Data Costs - Cloud &amp; Connectivity - mangOH forum</title>
    <meta name="description" content="I have a modified version of RedSensorToCloud which retries a data connection every 5 minutes if  LE_AVDATA_SESSION_STOPPED occurs.  This seems to be generating a lot of connection device registrations on Air Vantage whe&amp;hellip;">
    <meta name="generator" content="Discourse 3.2.0.beta2-dev - https://github.com/discourse/discourse version 11176407155714e2ebc3885a5f3301a2b4d37c5b">
<link rel="icon" type="image/png" href="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/c8f691ef20d8b5ee5eb3e88daa9a37267fd8b5c6_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/1X/c9436805837dffdd4ff80102c98ca366d74fee66_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636" />

<link rel="search" type="application/opensearchdescription+xml" href="https://forum.mangoh.io/opensearch.xml" title="mangOH forum Search">

    <link href="https://sea2.discourse-cdn.com/business6/stylesheets/color_definitions_mangoh-color-scheme_1_1_22c40ac3b958048f5d2773ba7c6e0a583de42cca.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/checklist_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-adplugin_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-adplugin"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-akismet_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-akismet"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-cakeday_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-data-explorer_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-data-explorer"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-details_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-footnote_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-footnote"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-lazy-videos_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-local-dates_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-narrative-bot_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-policy_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-policy"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-post-voting_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-post-voting"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-presence_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-solved_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-solved"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-spoiler-alert_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-spoiler-alert"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-templates_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-templates"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-topic-voting_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/hosted-site_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="hosted-site"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/poll_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-post-voting_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-post-voting_desktop"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/discourse-topic-voting_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/poll_desktop_fbfeae940828649b0abf03cf5cf6eebbf6949dd1.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://sea2.discourse-cdn.com/business6/stylesheets/desktop_theme_1_ab9b3e277688d87911f25cd6e1b20eb3d4321381.css?__ws=forum.mangoh.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="1" data-theme-name="mangoh"/>

    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-718568-6" data-json="{&quot;cookieDomain&quot;:&quot;mangoh.io&quot;}" data-auto-link-domains="">

  <link rel="preload" href="https://global.discourse-cdn.com/business6/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.br.js" as="script">
<script defer src="https://global.discourse-cdn.com/business6/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.br.js"></script>


        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Poor Signal Quality and Air Vantage Data Costs&#39;" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636.rss" />
    <meta property="og:site_name" content="mangOH forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/3a6474224b6583b6512ef6a5cd02d7d66cc320b7.png" />
<meta property="og:image" content="https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/3a6474224b6583b6512ef6a5cd02d7d66cc320b7.png" />
<meta property="og:url" content="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636" />
<meta name="twitter:url" content="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636" />
<meta property="og:title" content="Poor Signal Quality and Air Vantage Data Costs" />
<meta name="twitter:title" content="Poor Signal Quality and Air Vantage Data Costs" />
<meta property="og:description" content="I have a modified version of RedSensorToCloud which retries a data connection every 5 minutes if  LE_AVDATA_SESSION_STOPPED occurs.  This seems to be generating a lot of connection device registrations on Air Vantage when the cellular connection is poor (IE 1 bar).  What is the best way to avoid this additional cost?  I’m thinking it would be better to check the cell signal level and only attempt a session if the signal level is above a threshold after some number of attempts but I’m not sure if..." />
<meta name="twitter:description" content="I have a modified version of RedSensorToCloud which retries a data connection every 5 minutes if  LE_AVDATA_SESSION_STOPPED occurs.  This seems to be generating a lot of connection device registrations on Air Vantage when the cellular connection is poor (IE 1 bar).  What is the best way to avoid this additional cost?  I’m thinking it would be better to check the cell signal level and only attempt a session if the signal level is above a threshold after some number of attempts but I’m not sure if..." />
<meta property="og:article:section" content="Cloud &amp; Connectivity" />
<meta property="og:article:section:color" content="ED207B" />
<meta property="article:published_time" content="2019-05-14T05:37:20+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Poor Signal Quality and Air Vantage Data Costs","mainEntity":{"@type":"Question","name":"Poor Signal Quality and Air Vantage Data Costs","text":"I have a modified version of RedSensorToCloud which retries a data connection every 5 minutes if  LE_AVDATA_SESSION_STOPPED occurs.  This seems to be generating a lot of connection device registrations on Air Vantage when the cellular connection is poor (IE 1 bar).\n\nWhat is the best way to avoid thi&hellip;","upvoteCount":0,"answerCount":1,"dateCreated":"2019-05-14T05:37:20.200Z","author":{"@type":"Person","name":"Darren Beckwith"},"acceptedAnswer":{"@type":"Answer","text":"Here is my opinion:\n\n#1) It is best if you can tear down session if you know for sure you don’t need it for a long time. To save power. But if you transfer every 5 minutes it may be better to keep data session up all the time to save bandwidth.\n\n#2) Yes, le_avdata_ReleaseSession() should be called","upvoteCount":0,"dateCreated":"2019-05-14T21:38:27.509Z","url":"https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636/8","author":{"@type":"Person","name":"Prush"}}}}</script>
  </head>
  <body class="crawler ">
    <!--
<div id="navmenucontainer" class="container">
<div id="navmenuv">
    <ul class="nav">
      <li><a href="http://mangoh.io/">Project mangOH</a></li>
      <li><a href="http://mangoh.io/mango-green.html">mangOH Green</a></li>
      <li><a href="http://mangoh.io/buy-mangoh.html">Buy</a></li>
      <li><a href="http://mangoh.io/build-your-own.html">Build your own</a></li>
    </ul>
</div>
</div>
-->
    <header>
  <a href="/">
    mangOH forum
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="/t/poor-signal-quality-and-air-vantage-data-costs/2636">Poor Signal Quality and Air Vantage Data Costs</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.mangoh.io/c/connectivity/14" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #ED207B'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Cloud &amp; Connectivity</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Poor Signal Quality and Air Vantage Data Costs'>
        <meta itemprop='articleSection' content='Cloud &amp; Connectivity'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='mangOH forum'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://global.discourse-cdn.com/business6/uploads/mangoh/original/1X/284b9ca2de433d1cdfe5448455df1b398c8cc9c8.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/dbeckwith'><span itemprop='name'>dbeckwith</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T05:37:20Z' class='post-time'>
                    May 14, 2019,  5:37am
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T05:37:20Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <p>I have a modified version of <code>RedSensorToCloud</code> which retries a data connection every 5 minutes if  <code>LE_AVDATA_SESSION_STOPPED</code> occurs.  This seems to be generating a lot of connection device registrations on Air Vantage when the cellular connection is poor (IE 1 bar).</p>
<p>What is the best way to avoid this additional cost?  I’m thinking it would be better to check the cell signal level and only attempt a session if the signal level is above a threshold after some number of attempts but I’m not sure if this makes sense.</p>
<p>Thoughts?</p>
<p>Thanks,<br>
Darren</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://forum.mangoh.io/t/missing-call-to-airvantage-session-state-handler/2650">Missing Call to AirVantage Session State Handler</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/asyal'><span itemprop='name'>asyal</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T15:54:04Z' class='post-time'>
                    May 14, 2019,  3:54pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T15:54:04Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-post="1" data-topic="2636">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://sea2.discourse-cdn.com/business6/user_avatar/forum.mangoh.io/dbeckwith/40/772_2.png" class="avatar"> dbeckwith:</div>
<blockquote>
<p>What is the best way to avoid this additional cost? I’m thinking it would be better to check the cell signal level and only attempt a session if the signal level is above a threshold after some number of attempts but I’m not sure if this makes sense.</p>
</blockquote>
</aside>
<p>Hi Darren,</p>
<p>Can you look at the following Legato API:<br>
<a href="https://docs.legato.io/19_01/le__mrc__interface_8h_source.html" class="onebox" target="_blank" rel="nofollow noopener">https://docs.legato.io/19_01/le__mrc__interface_8h_source.html</a></p>
<p>specifically you can look at --&gt;</p>
<ol>
<li>le_mrc_MeasureSignalMetrics()</li>
<li>For e.g. for GSM :   le_mrc_GetGsmSignalMetrics(metricsRef, &amp;rxLevel, &amp;er);</li>
</ol>
<p>This should help you get the signal strength and then make a decision based on that.<br>
Does that help?</p>
<p>cheers,<br>
Ashish</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/dbeckwith'><span itemprop='name'>dbeckwith</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T16:05:54Z' class='post-time'>
                    May 14, 2019,  4:05pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T16:05:54Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/asyal">@asyal</a> Yes, that helps and I stumbled on this late last night in this post <a href="https://forum.legato.io/t/airvantage-data-push-stops-after-some-time/3450/2" rel="nofollow noopener">https://forum.legato.io/t/airvantage-data-push-stops-after-some-time/3450/2</a></p>
<p>Would you recommend these checks are performed before a call to <code>le_avdata_RequestSession</code>?  We have had some problems with the data session not reconnecting unless we reboot the modem is this normal or should we be able to restart the app and acquire a data connection again?</p>
<p>Also does the modem automatically try and connect to the cellular network once it boots?  Are they docs that talk about this behaviour?</p>
<p>Thanks,<br>
Darren</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Prush'><span itemprop='name'>Prush</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T17:50:28Z' class='post-time'>
                    May 14, 2019,  5:50pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T17:50:28Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi Darren, You don’t have to reboot the modem to reestablish the cellular connection. You should be able to reconnect if you release the session and request session again. A quick way to check cellular connection is also by using the ‘cm tool’. Use commands ‘cm radio’, ‘cm data’. Typically after a boot the device will connect to the cellular network but you have to request a data connect explicitly.</p>
<p><strong>Right after boot</strong><br>
root@swi-mdm9x28-wp:~# cm data<br>
Index:                         1<br>
APN:                           ltemobile.apn<br>
PDP Type:                      IPV4<br>
Connected:                     no<br>
root@swi-mdm9x28-wp:~# cm radio<br>
Power:                         ON<br>
Current Network Operator:      Rogers Wireless<br>
Current RAT:                   GSM network (LE_MRC_RAT_GSM)<br>
Status:                        Registered, home network (LE_MRC_REG_HOME)<br>
Signal:                        Very strong signal strength (5)<br>
PS:                            Packet Switched Registered, home network (LE_MRC_REG_HOME)</p>
<p><strong>Explicit data connection</strong><br>
root@swi-mdm9x28-wp:~# cm data connect<br>
Setting up profile 1<br>
Connecting … ok<br>
Checking if device ‘rmnet_data0’ is up … ok<br>
Routing inet … ok<br>
mv: can’t remove ‘/etc/resolv.conf’: Device or resource busy<br>
Updating /etc/resolv.conf … ok<br>
Updating /etc/resolv.conf … ok<br>
Testing connection … ok<br>
root@swi-mdm9x28-wp:~# cm data<br>
Index:                         1<br>
APN:                           ltemobile.apn<br>
PDP Type:                      IPV4<br>
Connected:                     yes<br>
Interface:                     rmnet_data0<br>
Family[IPv4]:                  inet<br>
IP[IPv4]:                      25.167.7.155<br>
Gateway[IPv4]:                 25.167.7.156<br>
Dns1[IPv4]:                    64.71.255.254<br>
Dns2[IPv4]:                    64.71.255.253<br>
root@swi-mdm9x28-wp:~#</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/dbeckwith'><span itemprop='name'>dbeckwith</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T18:11:01Z' class='post-time'>
                    May 14, 2019,  6:11pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T18:11:01Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/prush">@Prush</a></p>
<p>Thanks for the help and the pointers about the <code>cm</code> tool.  I noticed while I was debugging today that <code>le_avdata_RequestSession</code> seems to return a non-null reference even when cm radio indicated no network connection.  Is this normal?</p>
<p>Sounds like <code>le_avdata_ReleaseSession()</code> should be called if <code>le_avdata_RequestSession</code> returned a non-null reference, correct.</p>
<p>Thanks,<br>
Darren</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Prush'><span itemprop='name'>Prush</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T19:28:08Z' class='post-time'>
                    May 14, 2019,  7:28pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T19:28:08Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Most cases you will get a non-null reference unless the service ran out of resources. Getting a non-null reference doesn’t imply you have a connection to the server. You still have to wait for events from avc service.</p>
<p>Look at the sample in:</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/legatoproject/legato-af/blob/master/apps/sample/assetData/assetDataComponent/main.c" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/legatoproject/legato-af/blob/master/apps/sample/assetData/assetDataComponent/main.c" target="_blank" rel="nofollow noopener">legatoproject/legato-af/blob/master/apps/sample/assetData/assetDataComponent/main.c</a></h4>
<pre><code class="lang-c">#include "legato.h"
#include "interfaces.h"

// [DeclareVariables]
#define APP_RUNNING_DURATION_SEC 600        //run this app for 10min
// [AssetDataPath]
//-------------------------------------------------------------------------------------------------
/**
 * Declare asset data path
 */
//-------------------------------------------------------------------------------------------------

/* variables */
// string - room name
#define ROOM_NAME_VAR_RES   "/home1/room1/roomName"

// bool - status of air conditioning in the room ON or OFF
#define IS_AC_ON_VAR_RES   "/home1/room1/AC/IsACOn"

// float - room temperature reading
</code></pre>

  This file has been truncated. <a href="https://github.com/legatoproject/legato-af/blob/master/apps/sample/assetData/assetDataComponent/main.c" target="_blank" rel="nofollow noopener">show original</a>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>avcStatusHandler() will notify your app when the connection goes up/down.</p>
<p>When your app doesn’t need avdata connection you can call le_avdata_ReleaseSession(). When all clients release their sessions avms connection will be torn down.</p>
<p>The dependency for avc app is “avc -&gt; data connection service -&gt; modem service”.<br>
The cm tool is a debug tool which interacts directly with modem. You cannot compare events from modem service to events from avc.</p>
<p>For example, when avc indicates a connection is up, you can check the and rmnet interface and ip by running ‘cm data’. But when avc indicates that the avms connection is down, you might still see rmnet interface and ip depedning on if other app is using that channel.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/dbeckwith'><span itemprop='name'>dbeckwith</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T21:15:00Z' class='post-time'>
                    May 14, 2019,  9:15pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-15T20:16:12Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/prush">@Prush</a></p>
<p>Thanks for the sample code reference but I’m not sure how similar this app is to our sensorToCloud app. The AssetData app purposely stops sending data after 10 minutes.</p>
<p>Our app opens a data connection and then keeps trying that data connection (every 5 minutes) if the response handler isn’t called.  After 10 minutes it gives up and reboots.</p>
<p>I’m trying illuminate the reboots and at the same time optimize LWM2M session data costs.  So I better understand.</p>
<ol>
<li>Is it best practice to setup and tear down a data session or should a data sessions be setup for as long as possible?</li>
<li>Should <code>le_avdata_ReleaseSession</code> be called before attempting to call <code>le_avdata_RequestSession</code> if the first call to <code>le_avdata_RequestSession</code> returned a non-null reference?</li>
</ol>
<p>Answer to 2: Looking at avcData.c in avcDaemon <code>le_avdata_RequestSession</code> will return the existing reference if it’s a duplicate request.  So no need to release the session before trying again.</p>
<p>Thanks,<br>
Darren</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.mangoh.io/u/Prush'><span itemprop='name'>Prush</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://forum.mangoh.io/t/poor-signal-quality-and-air-vantage-data-costs/2636">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-05-14T21:38:27Z' class='post-time'>
                    May 14, 2019,  9:38pm
                  </time>
                  <meta itemprop='dateModified' content='2019-05-14T21:38:27Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Here is my opinion:<br>
<span class="hashtag">#1</span>) It is best if you can tear down session if you know for sure you don’t need it for a long time. To save power. But if you transfer every 5 minutes it may be better to keep data session up all the time to save bandwidth.<br>
<span class="hashtag">#2</span>) Yes, le_avdata_ReleaseSession() should be called</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://forum.mangoh.io/t/multiple-apps-calling-le-avdata-requestsession/2646/3">Multiple Apps Calling `le_avdata_RequestSession`</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
