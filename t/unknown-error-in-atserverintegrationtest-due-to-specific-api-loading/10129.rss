<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
    <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129</link>
    <description>Hi, I am testing legato applications in GL7605.
I try to install &quot;[atServerIntegrationTest](https://github.com/legatoproject/legato-af/tree/master/apps/test/atServices/atServerIntegrationTest)&quot; in legato-af and overwrite a new command. 
I could get the unedited sample atServerIntegrationTest with reference to [https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/15](https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/15) .
I want to add an AT command and need the API with SIM information.
However, when I overwrote .adef and .cdef to add the API &quot;le_sim.api&quot;, a command is not working properly.
I would like you to investigate the cause of the problem.

More details are described below.

* PC environment: Ubuntu 20.04.4 LTS 64 bit/ 5.15.0-46-generic
* Product: GL7605 w/ WP7605 version SWI9X07Y_02.28.03.05 (from AT+GMR)
* leaf version: 2.4.0 / swi-wp76_4.0.3
* legato version: 19.02.0_4cb954265427b8c2c668a010ff5be274_modified
* Settings: 
```
＞AT!ENTERCND=“A710”
＞AT!USBCOMP=1,1,8014D
```
* Error command: 
```
$ ssh root@192.168.2.2
# app runProc atServerIntegrationTest --exe=atServerTest -- tty /dev/ttyHS0
```
If normal, during the execution of this command, UART will receive AT command input.
However, when I add the le_sim.api description, the command exits immediately after execution.
I tried with other APIs (e.g. le_antenna.api) and it works correctly.

* Overwitten content:
1. Component.cdef
```
api{
 atServices/le_atServer.api
 (my directory)/legato-af/interfaces/modemServices/le_mcc.api *
 (my directory)/legato-af/interfaces/modemServices/le_sim.api
}
```
*The sample code could not read le_mcc.api, so it is rewritten.

2. atServerIntegrationTest.adef
```
bindings{
 atServerTest.atServerTestComp.le_atServer -&gt; atService.le_atServer
 atServerTest.atServerTestComp.le_mcc -&gt; atService.le_mcc
 atServerTest.atServerTestComp.le_sim -&gt; atService.le_sim
}
```</description>
    
    <lastBuildDate>Tue, 01 Nov 2022 06:53:51 +0000</lastBuildDate>
    <category>Uncategorized</category>
    <atom:link href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>Thank you for your debugging.<br>
I had forgotten to change the memset() argument when I changed Number array.<br>
AT&amp;P now runs and exits successfully.</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/17</link>
        <pubDate>Tue, 01 Nov 2022 06:53:51 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-17</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>Your memset() has set wrong size for Number, that is why you see segmentation fault.<br>
You should use this in your code:</p>
<pre><code class="lang-auto">static void automaticTest_AtNumberHandler
(
    le_atServer_CmdRef_t commandRef,
    le_atServer_Type_t type,
    uint32_t parametersNumber,
    void* contextPtr
)
{

#if 0
    char Number[LE_MDMDEFS_PHONE_NUM_MAX_BYTES]; //phone number container
    char rsp1[LE_ATDEFS_RESPONSE_MAX_BYTES]; // display char
    memset(Number, 0, LE_ATDEFS_RESPONSE_MAX_BYTES); // All zero initialize
    memset(rsp1, 0, LE_ATDEFS_RESPONSE_MAX_BYTES); // All zero initialize
    snprintf(rsp1, LE_ATDEFS_RESPONSE_MAX_BYTES, "ID="); // initial string
    static le_sim_Id_t SimId = LE_SIM_EXTERNAL_SLOT_1; // Container of Sim State

    // PrepareHandler(commandRef, type, parametersNumber, contextPtr);
    //Prepare_http_Handler(commandRef, type, parametersNumber, contextPtr);
    le_sim_GetSubscriberPhoneNumber(SimId, Number,  sizeof(Number));

    snprintf(rsp1+strlen(rsp1), sizeof(Number), "%s", Number); // marge phone number
    LE_ASSERT(le_atServer_SendIntermediateResponse(commandRef, rsp1) == LE_OK); // display ID=Num

    // LE_ASSERT(le_atServer_SendFinalResultCode(commandRef, LE_ATSERVER_OK, "", 0) == LE_OK); // OK
    LE_ASSERT(le_atServer_SendFinalResponse(commandRef, LE_ATSERVER_OK, false, "") == LE_OK);
#else


    char Number[LE_MDMDEFS_PHONE_NUM_MAX_BYTES]; //phone number container
        char rsp1[LE_ATDEFS_RESPONSE_MAX_BYTES]; // display char
        memset(Number, 0, LE_MDMDEFS_PHONE_NUM_MAX_BYTES); // All zero initialize
        memset(rsp1, 0, LE_ATDEFS_RESPONSE_MAX_BYTES); // All zero initialize
        snprintf(rsp1, LE_ATDEFS_RESPONSE_MAX_BYTES, "ID="); // initial string
        static le_sim_Id_t SimId = LE_SIM_EXTERNAL_SLOT_1; // Container of Sim State

        // PrepareHandler(commandRef, type, parametersNumber, contextPtr);
        //Prepare_http_Handler(commandRef, type, parametersNumber, contextPtr);
        le_sim_GetSubscriberPhoneNumber(SimId, Number,  sizeof(Number));

        snprintf(rsp1+strlen(rsp1), sizeof(Number), "%s", Number); // marge phone number
       LE_ASSERT(le_atServer_SendIntermediateResponse(commandRef, rsp1) == LE_OK); // display ID=Num



    PrepareHandler(commandRef, type, parametersNumber, contextPtr);
        // Send Final response
        LE_ASSERT(le_atServer_SendFinalResponse(commandRef, LE_ATSERVER_OK, false, "") == LE_OK);


#endif
    return;
}
</code></pre>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/16</link>
        <pubDate>Thu, 27 Oct 2022 10:07:49 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-16</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>Sorry, I tried the operation you suggested but it did not succeed.<br>
I will share the file I am editing.<br>
Would you please test the operation in the same environment?<br>
Please replace the folder with the sample on Git “/legato-af/apps/test/atServices/atServerIntegrationTest/” and run it. (I deleted CMakeLists.txt by mistake, please add it.)</p>
<p>Below are the details of the operations I perform.</p>
<ol>
<li>Connect GL7605 with a miniSIM(in EXTERNAL_SLOT_1) to Ubunutu PC via USB (/dev/ttyUSB0,1,2)</li>
<li>Set as follows</li>
</ol>
<pre><code class="lang-auto">$ screen /dev/ttyUSB2
&gt; AT!MAPUART=17,1
&gt; AT!ENTERCND="A710"
&gt; AT!USBCOMP=1,1,8014D
&gt; AT!RESET
</code></pre>
<ol start="3">
<li>Connect via SSH and run app runProc</li>
</ol>
<pre><code class="lang-auto">$ ssh root@192.168.2.2
# app start atServerIntegrationTest
# app runProc atServerIntegrationTest --exe=atServerTest -- tty /dev/ttyHS0
(wait)
</code></pre>
<ol start="4">
<li>Connect GL7605 to PC via UART and access /dev/ttyUSB3 from another terminal</li>
<li>Set as follows</li>
</ol>
<pre><code class="lang-auto">&gt; ATE1
&gt; AT+BRIDGE="OPEN"
&gt; AT+BRIDGE="ADD"
&gt; AT+KHTTPCFG=0,“116.66.221.43”,80,1
</code></pre>
<ol start="6">
<li>Input AT&amp;P</li>
</ol>
<pre><code class="lang-auto">&gt; AT&amp;P
ID=***********
OK
</code></pre>
<ol start="7">
<li>app runProc crashes and you can’t input AT commands</li>
</ol>
<p><a class="attachment" href="https://forum.mangoh.io/uploads/short-url/wPr6SSYAZ7AbGBj0VW47u3fKctZ.zip">atServerIntegrationTest.zip</a> (12.5 KB)</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/15</link>
        <pubDate>Thu, 27 Oct 2022 09:51:59 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-15</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>Didn’t you can run the program by AT+KHTTPCFG?<br>
If so, you can compare the routine of AT+KHTTPCFG and that of AT&amp;P and figure out which line is making the crash, right?</p>
<p>For other command to try:</p>
<pre><code class="lang-auto">
 AT+KHTTPCFG=0,"123.123.123.123",80,1    , you should see the following response:
*****
+KHTTPCFG PARAM 0: 0
+KHTTPCFG PARAM 1: 123.123.123.123
+KHTTPCFG PARAM 2: 80
+KHTTPCFG PARAM 3: 1

OK
*****


AT+KHTTPGET=0,"/index.php"    , you should see the following response:
*****
+KHTTPGET PARAM 0: 0
+KHTTPGET PARAM 1: /index.php
CONNECT
HTTP/1.1 200 OK
Date: Fri, 17 Jan 2020 09:38:13 GMT
Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2h PHP/5.6.26
X-Powered-By: PHP/5.6.26
Content-Length: 4
Content-Type: text/html; charset=UTF-8

test

OK
*****


type AT+KHTTPCLOSE=0    , you should see the following response:
*****
+KHTTPCLOSE PARAM 0: 0

OK

*****
</code></pre>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/14</link>
        <pubDate>Fri, 21 Oct 2022 08:14:18 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-14</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for sharing many links.<br>
After trying various settings, I noticed that the argument used for le_sim_GetSubscriberPhoneNumber() was set incorrectly with the information of the SIM being used.<br>
By modifying as follows, the phone number was successfully output.</p>
<pre><code class="lang-auto">static le_sim_Id_t SimId = LE_SIM_EXTERNAL_SLOT_1;
LE_ASSERT(le_sim_GetSubscriberPhoneNumber(SimId, Number, sizeof(Number)) == LE_OK);
</code></pre>
<p>However, “app runProc” still crushes after executing “AT&amp;P” command, and I cannot figure out why.<br>
After adding the description about AT+KHTTPCFG, the following error statement appears at the time of crash.</p>
<pre><code class="lang-auto">$ ssh root@192.168.2.2
root@swi-mdm9x28-wp:~# app start atServerIntegrationTest
root@swi-mdm9x28-wp:~# app runProc atServerIntegrationTest --exe=atServerTest -- tty /dev/ttyHS0
PROCESS: 2213 ,TID 2213
SIGNAL: 11, ADDR (nil), AT (nil) SI_CODE 0x00000001
ILLEGAL ADDRESS (nil)
LEGATO VERSION
19.02.0_4cb954265427b8c2c668a010ff5be274_modified

PROCESS COMMAND LINE
atServerTest@0 tty /dev/ttyHS0 
PROCESS MAP
7f555000-7f556000 r-xp 00000000 ed:01 85315      /legato/apps/ad152a34190881e1112013e3aeb7de70/read-only/bin/atServerTest
7f566000-7f567000 r--p 00001000 ed:01 85315      /legato/apps/ad152a34190881e1112013e3aeb7de70/read-only/bin/atServerTest
7f567000-7f568000 rw-p 00002000 ed:01 85315      /legato/apps/ad152a34190881e1112013e3aeb7de70/read-only/bin/atServerTest
7f568000-7f5ae000 rw-p 00000000 00:00 0          [heap]
b6c5b000-b6d87000 r-xp 00000000 fe:00 835        /lib/libc-2.27.so

[…]

ffff0000-ffff1000 r-xp 00000000 00:00 0          [vectors]
BACKTRACE
PC at 00000000
LR at 00000000 [0xbe9c0634]
r0  00000000 r1  00000001 r2  b6ed68c0 r3  00000000 r4  00000000  r5  7f56a5a8
r6  00000000 r7  be9c0a30 r8  00000003 r9  b6ed6000 r10 7f567000 cpsr 60070010
fp  00000000 ip  00000000 sp  be9c09a8 lr  00000000 pc  00000000
STACK be9c09a8, FRAME 00000000
be9c0928: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000

[...]
Abort while dumping the stack
DONE
root@swi-mdm9x28-wp:~#
</code></pre>
<p>Do you know why it crashes?<br>
Also, in the “atServerIntegrationTest”, are there any other APIs other than the ones quoted in the test file that are guaranteed to work?</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/13</link>
        <pubDate>Fri, 21 Oct 2022 07:44:13 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-13</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>For le_sim_GetSubscriberPhoneNumber(), you can run this component and see if there is problem:</p>
<aside class="onebox githubfolder" data-onebox-src="https://github.com/legatoproject/legato-af/tree/master/apps/test/modemServices/sim/simUnitTest">
  <header class="source">
      <img src="https://global.discourse-cdn.com/business6/uploads/mangoh/original/2X/b/bad3e5f9ad67c1ddf145107ce7032ac1d7b22563.svg" class="site-icon" width="32" height="32">

      <a href="https://github.com/legatoproject/legato-af/tree/master/apps/test/modemServices/sim/simUnitTest" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h3><a href="https://github.com/legatoproject/legato-af/tree/master/apps/test/modemServices/sim/simUnitTest" target="_blank" rel="noopener nofollow ugc">legato-af/apps/test/modemServices/sim/simUnitTest at master ·...</a></h3>

  <p><a href="https://github.com/legatoproject/legato-af/tree/master/apps/test/modemServices/sim/simUnitTest" target="_blank" rel="noopener nofollow ugc">master/apps/test/modemServices/sim/simUnitTest</a></p>

  <p><span class="label1">Legato Application Framework. Contribute to legatoproject/legato-af development by creating an account on GitHub.</span></p>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Also you can refer to the CM tool which uses the same API le_sim_GetSubscriberPhoneNumber():</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/legatoproject/legato-af/blob/master/apps/tools/cm/cm_sim.c">
  <header class="source">

      <a href="https://github.com/legatoproject/legato-af/blob/master/apps/tools/cm/cm_sim.c" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/legatoproject/legato-af/blob/master/apps/tools/cm/cm_sim.c" target="_blank" rel="noopener nofollow ugc">legatoproject/legato-af/blob/master/apps/tools/cm/cm_sim.c</a></h4>


      <pre><code class="lang-c">//-------------------------------------------------------------------------------------------------
/**
 * @file cm_sim.c
 *
 * Handle sim related functionality
 *
 * Copyright (C) Sierra Wireless Inc.
 */
//-------------------------------------------------------------------------------------------------

#include "legato.h"
#include "interfaces.h"
#include "cm_sim.h"
#include "cm_common.h"

static le_sim_Id_t SimId;

//-------------------------------------------------------------------------------------------------
/**
 * Print the help text to stdout.
</code></pre>



  This file has been truncated. <a href="https://github.com/legatoproject/legato-af/blob/master/apps/tools/cm/cm_sim.c" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>For le_sim_GetIMSI(), you can refer to this modemdemo sample application:</p><aside class="onebox githubblob" data-onebox-src="https://github.com/legatoproject/legato-af/blob/master/apps/sample/modemDemo/demoComponent/demo.c">
  <header class="source">

      <a href="https://github.com/legatoproject/legato-af/blob/master/apps/sample/modemDemo/demoComponent/demo.c" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/legatoproject/legato-af/blob/master/apps/sample/modemDemo/demoComponent/demo.c" target="_blank" rel="noopener nofollow ugc">legatoproject/legato-af/blob/master/apps/sample/modemDemo/demoComponent/demo.c</a></h4>


      <pre><code class="lang-c">
#include &lt;arpa/inet.h&gt;

/* Legato Framework */
#include "legato.h"

/* IPC APIs */
#include "interfaces.h"

// -------------------------------------------------------------------------------------------------
/**
 *  Sierra Wireless server IP address used for data connection testing.
 */
// -------------------------------------------------------------------------------------------------
#define SERVER_ADDR_V4 "69.10.131.102"
#define SERVER_ADDR_V6 "2a01:cd00:ff:ffff::450a:8366"
#define BUFFER_SIZE 10240

// -------------------------------------------------------------------------------------------------
/**
</code></pre>



  This file has been truncated. <a href="https://github.com/legatoproject/legato-af/blob/master/apps/sample/modemDemo/demoComponent/demo.c" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/12</link>
        <pubDate>Wed, 05 Oct 2022 07:15:56 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-12</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>I isolated the problem and AT&amp;P without le_sim_GetSubscriberPhoneNumber() is running fine.<br>
This is no different than before running AT+KHTTPCFG.</p>
<p>In summary, I guess the use of le_sim_GetSubscriberPhoneNumber()  is preventing the app runProc from running.<br>
I tried to create an AT command using le_sim_GetIMSI(), and app runProc terminated in the same way.<br>
I think le_sim.api affects app runProc or there is a problem with the function loading way.<br>
Is there any bug inthe function loading way in my program?</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/11</link>
        <pubDate>Wed, 05 Oct 2022 07:03:15 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-11</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>If you put your code with le_sim_GetSubscriberPhoneNumber() function to Prepare_http_Handler() and trigger AT+KHTTPCFG, will it crash?</p>
<p>This can isolate if your code has problem.<br>
If no problem is found, that means your code on AT&amp;P has problem</p>
<p>Or you can delete your code with le_sim_GetSubscriberPhoneNumber() function in automaticTest_AtNumberHandler() and see if the AT&amp;P still trigger the crash.</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/10</link>
        <pubDate>Wed, 05 Oct 2022 02:44:57 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-10</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>mkapp is running fine and not getting any error messages.<br>
The AT+KHTTPCFG settings are also working fine, but still app runProc is terminated as soon as AT&amp;P is executed.</p>
<p>Is there anything else I should rewrite besides Prepare_http_Handler()?</p>
<pre><code class="lang-auto">void automaticTest_AtNumberHandler
(
    le_atServer_CmdRef_t commandRef,
    le_atServer_Type_t type,
    uint32_t parametersNumber,
    void* contextPtr
)
{

    int NumberLength = 11;
    char Number[LE_ATDEFS_RESPONSE_MAX_BYTES]; //phone number container
    char rsp1[LE_ATDEFS_RESPONSE_MAX_BYTES]; // disply char
    memset(rsp1, 0, LE_ATDEFS_RESPONSE_MAX_BYTES); // All zero initialize
    snprintf(rsp1, LE_ATDEFS_RESPONSE_MAX_BYTES, "ID="); // initial string

    Prepare_http_Handler(commandRef, type, parametersNumber, contextPtr);
    LE_ASSERT(le_sim_GetSubscriberPhoneNumber(LE_SIM_EMBEDDED, Number, NumberLength) == LE_OK);
    snprintf(rsp1+strlen(rsp1), NumberLength, "%s", Number); // marge phone number
    LE_ASSERT(le_atServer_SendIntermediateResponse(commandRef, rsp1) == LE_OK); // display ID=Num

    LE_ASSERT(le_atServer_SendFinalResultCode(commandRef, LE_ATSERVER_OK, "", 0) == LE_OK); // OK

    return;
}

</code></pre>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/9</link>
        <pubDate>Wed, 05 Oct 2022 02:24:59 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-9</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>have you tried to debug it?<br>
which line is making the error?</p>
<p>If you put your code with le_sim_GetSubscriberPhoneNumber() function to Prepare_http_Handler() and trigger AT+KHTTPCFG, will it crash?</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/8</link>
        <pubDate>Tue, 04 Oct 2022 08:09:28 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-8</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>I did not use it.<br>
I download it from the URL and run AT+KHTTPCFG.<br>
However, when I try to run the AT&amp;P (I added), “app runProc …” is  terminated.</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/7</link>
        <pubDate>Tue, 04 Oct 2022 07:22:02 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-7</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>does it work for AT+KHTTPCFG if you are using the code here?</p><aside class="quote quote-modified" data-post="17" data-topic="4803">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="20" height="20" src="https://sea2.discourse-cdn.com/business6/user_avatar/forum.mangoh.io/jyijyi/40/997_2.png" class="avatar">
    <a href="https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/17">AT cmds for Mirage Talon from MangoH Red board AT port</a> <a class="badge-wrapper  bullet" href="https://forum.mangoh.io/c/mangoh-red/12"><span class="badge-category-bg" style="background-color: #DF1E2E;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="https://mangoh.io/mangoh-red">mangOH Red</span></a>
  </div>
  <blockquote>
    You can use my attached application as reference. 
Steps: 


enter the following AT commands in AT command port: 
AT!ENTERCND=“A710” 
AT!USBCOMP=1,1,8014D 
at!RESET 


compile and download the application 


in console type the following: 
app runProc atServerIntegrationTest --exe=atServerTest – tty /dev/ttyGS1 



in the new raw data port (check in device manager), type ATE1, you should see the following response: 

E TYPE: PARA 
E PARAM 0: 1 
OK 




at+bridge=“OPEN” 
+BRIDGE TYPE: PARA 
+BRID…
  </blockquote>
</aside>

<p>If it works, you can modify the code of +KHTTPCFG</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/6</link>
        <pubDate>Tue, 04 Oct 2022 05:35:42 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-6</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>Thank you for your response, I solved the problem by changing the options in mkapp as follows.</p>
<pre><code class="lang-auto">mkapp -t wp76xx atServerIntegrationTest.adef -i ${LEGATO_ROOT}/interfaces/modemServices
</code></pre>
<p>I have another problem while writing the program, so let me ask you about it.<br>
I am first trying to create an AT command, AT&amp;P, with the equivalent functionality of AT+CNUM.<br>
I  use the le_sim_GetSubscriberPhoneNumber() function to get the SIM phone number, but the AT command port is frozen when I enter AT&amp;P.<br>
If the program is written incorrectly, please tell us how to write it correctly.</p>
<p>I write below in atServerTest.c.<br>
I would like to display<br>
“ID=<em>PhoneNumber</em><br>
OK”<br>
No compilation errors have occurred.</p>
<pre><code class="lang-auto">void automaticTest_AtNumberHandler
(
    le_atServer_CmdRef_t commandRef,
    le_atServer_Type_t type,
    uint32_t parametersNumber,
    void* contextPtr
)
{

    int NumberLength = 11;
    char Number[LE_ATDEFS_RESPONSE_MAX_BYTES]; //phone number container
    char rsp1[LE_ATDEFS_RESPONSE_MAX_BYTES]; // display char
   memset(Number, 0, LE_ATDEFS_RESPONSE_MAX_BYTES); // All zero initialize 
   memset(rsp1, 0, LE_ATDEFS_RESPONSE_MAX_BYTES); // All zero initialize
    snprintf(rsp1, LE_ATDEFS_RESPONSE_MAX_BYTES, "ID="); // initial string

    PrepareHandler(commandRef, type, parametersNumber, contextPtr);
    LE_ASSERT(le_sim_GetSubscriberPhoneNumber(LE_SIM_EMBEDDED, Number, NumberLength) == LE_OK);
    snprintf(rsp1+strlen(rsp1), NumberLength, "%s", Number); // marge phone number
    LE_ASSERT(le_atServer_SendIntermediateResponse(commandRef, rsp1) == LE_OK); // display ID=Num

    LE_ASSERT(le_atServer_SendFinalResultCode(commandRef, LE_ATSERVER_OK, "", 0) == LE_OK); // OK

    return;
}

</code></pre>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/5</link>
        <pubDate>Tue, 04 Oct 2022 05:17:49 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-5</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>it should be:</p>
<pre><code class="lang-auto">
api:
{
        atServices/le_atServer.api
        le_mcc.api
        le_sim.api
}

bindings:
{
    atServerTest.atServerTestComp.le_atServer -&gt; atService.le_atServer
    atServerTest.atServerTestComp.le_mcc -&gt; modemService.le_mcc
    atServerTest.atServerTestComp.le_sim -&gt; modemService.le_sim
}
</code></pre>
<p>If .api cannot be found during compilation, you can see here:</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://forum.legato.io/t/fx30s-build-error-couldnt-find-file-le-avc-api/5878/9">
  <header class="source">
      <img src="https://global.discourse-cdn.com/business6/uploads/mangoh/original/2X/2/2f530449ddf3c5969c6d457cc62c7f403f2ae1d3.png" class="site-icon" width="32" height="32">

      <a href="https://forum.legato.io/t/fx30s-build-error-couldnt-find-file-le-avc-api/5878/9" target="_blank" rel="noopener nofollow ugc" title="09:11AM - 22 July 2021">Legato Forum – 22 Jul 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:605/500;"><img src="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/2X/8/8e89806158439adea8adda32c5296db070d244d0_2_605x500.png" class="thumbnail" width="605" height="500" srcset="https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/2X/8/8e89806158439adea8adda32c5296db070d244d0_2_605x500.png, https://global.discourse-cdn.com/business6/uploads/mangoh/optimized/2X/8/8e89806158439adea8adda32c5296db070d244d0_2_907x750.png 1.5x, https://global.discourse-cdn.com/business6/uploads/mangoh/original/2X/8/8e89806158439adea8adda32c5296db070d244d0.png 2x" data-dominant-color="0A313C"></div>

<h3><a href="https://forum.legato.io/t/fx30s-build-error-couldnt-find-file-le-avc-api/5878/9" target="_blank" rel="noopener nofollow ugc">FX30S - Build Error - Couldn't find file 'le_avc.api'</a></h3>

  <p>Does your .sdef file in vscode show the airvantage directory:  // Interfaces are searched for in the following directories. Each directory/sub-directory needs to  // be identified here for the system to find and use .api files.  interfaceSearch:  { ...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/4</link>
        <pubDate>Fri, 30 Sep 2022 02:48:47 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-4</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for your reply.<br>
I have UART set up to recognize custom AT commands.<br>
I am following <a href="https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/15">https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/15</a>.<br>
In this forum, /dev/ttyHS0 which is equivalent to UART can receive AT commands while app runProc is running on USB.</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/3</link>
        <pubDate>Fri, 30 Sep 2022 02:13:20 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-3</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[jyijyi]]></dc:creator>
        <description><![CDATA[
            <p>you want to use UART or USB?</p>
<p>I saw you are configuring AT!USBCOMP but at the same time you are using /dev/ttyHS0</p>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/2</link>
        <pubDate>Fri, 30 Sep 2022 02:03:51 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-2</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
      <item>
        <title>Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</title>
        <dc:creator><![CDATA[takuyakobayashi]]></dc:creator>
        <description><![CDATA[
            <p>Hi, I am testing legato applications in GL7605.<br>
I try to install “<a href="https://github.com/legatoproject/legato-af/tree/master/apps/test/atServices/atServerIntegrationTest" rel="noopener nofollow ugc">atServerIntegrationTest</a>” in legato-af and overwrite a new command.<br>
I could get the unedited sample atServerIntegrationTest with reference to <a href="https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/15">https://forum.mangoh.io/t/at-cmds-for-mirage-talon-from-mangoh-red-board-at-port/4803/15</a> .<br>
I want to add an AT command and need the API with SIM information.<br>
However, when I overwrote .adef and .cdef to add the API “le_sim.api”, a command is not working properly.<br>
I would like you to investigate the cause of the problem.</p>
<p>More details are described below.</p>
<ul>
<li>PC environment: Ubuntu 20.04.4 LTS 64 bit/ 5.15.0-46-generic</li>
<li>Product: GL7605 w/ WP7605 version SWI9X07Y_02.28.03.05 (from AT+GMR)</li>
<li>leaf version: 2.4.0 / swi-wp76_4.0.3</li>
<li>legato version: 19.02.0_4cb954265427b8c2c668a010ff5be274_modified</li>
<li>Settings:</li>
</ul>
<pre><code class="lang-auto">＞AT!ENTERCND=“A710”
＞AT!USBCOMP=1,1,8014D
</code></pre>
<ul>
<li>Error command:</li>
</ul>
<pre><code class="lang-auto">$ ssh root@192.168.2.2
# app runProc atServerIntegrationTest --exe=atServerTest -- tty /dev/ttyHS0
</code></pre>
<p>If normal, during the execution of this command, UART will receive AT command input.<br>
However, when I add the le_sim.api description, the command exits immediately after execution.<br>
I tried with other APIs (e.g. le_antenna.api) and it works correctly.</p>
<ul>
<li>Overwitten content:</li>
</ul>
<ol>
<li>Component.cdef</li>
</ol>
<pre><code class="lang-auto">api{
 atServices/le_atServer.api
 (my directory)/legato-af/interfaces/modemServices/le_mcc.api *
 (my directory)/legato-af/interfaces/modemServices/le_sim.api
}
</code></pre>
<p>*The sample code could not read le_mcc.api, so it is rewritten.</p>
<ol start="2">
<li>atServerIntegrationTest.adef</li>
</ol>
<pre><code class="lang-auto">bindings{
 atServerTest.atServerTestComp.le_atServer -&gt; atService.le_atServer
 atServerTest.atServerTestComp.le_mcc -&gt; atService.le_mcc
 atServerTest.atServerTestComp.le_sim -&gt; atService.le_sim
}
</code></pre>
          <p><a href="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129/1</link>
        <pubDate>Fri, 30 Sep 2022 01:43:33 +0000</pubDate>
        <guid isPermaLink="false">forum.mangoh.io-post-10129-1</guid>
        <source url="https://forum.mangoh.io/t/unknown-error-in-atserverintegrationtest-due-to-specific-api-loading/10129.rss">Unknown error in &quot;atServerIntegrationTest&quot; due to specific API loading</source>
      </item>
  </channel>
</rss>
